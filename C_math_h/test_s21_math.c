#include <check.h>
#include <float.h>
#include <limits.h>
#include <math.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

#include "s21_math.h"
#include "test_utils.h"

// ------------------------------------------
// Tests
// ------------------------------------------
START_TEST(s21_isnan_test) {
  ck_assert(s21_isnan(0.0) == false);
  ck_assert(s21_isnan(1.0) == false);
  ck_assert(s21_isnan(DBL_MAX) == false);
  ck_assert(s21_isnan(-DBL_MAX) == false);

  ck_assert(s21_isnan(NAN));
  ck_assert(s21_isnan(-NAN));
  ck_assert(s21_isnan(+0.0 / 0.0));
  ck_assert(s21_isnan(-0.0 / 0.0));

  TEST_BOOL(isnan, INFINITY);
  TEST_BOOL(isnan, -INFINITY);
  TEST_BOOL(isnan, NAN);
  TEST_BOOL(isnan, -NAN);
}
END_TEST

START_TEST(s21_isinf_test) {
  ck_assert(s21_isinf(0.0) == false);
  ck_assert(s21_isinf(1.0) == false);
  ck_assert(s21_isnan(DBL_MAX) == false);
  ck_assert(s21_isnan(-DBL_MAX) == false);

  ck_assert(s21_isinf(+INFINITY));
  ck_assert(s21_isinf(-INFINITY));
  ck_assert(s21_isinf(+1.0 / 0.0));
  ck_assert(s21_isinf(-1.0 / 0.0));

  TEST_BOOL(isinf, INFINITY);
  TEST_BOOL(isinf, -INFINITY);
  TEST_BOOL(isinf, NAN);
  TEST_BOOL(isinf, -NAN);
}
END_TEST

START_TEST(s21_signbit_test) {
  ck_assert_int_eq(s21_signbit(+INFINITY), 0);
  ck_assert_int_eq(s21_signbit(+NAN), 0);
  ck_assert_int_eq(s21_signbit(+1.0), 0);
  ck_assert_int_eq(s21_signbit(+0.0), 0);
  ck_assert_int_eq(s21_signbit(0.0), 0);

  ck_assert_int_eq(s21_signbit(-INFINITY), 1);
  ck_assert_int_eq(s21_signbit(-NAN), 1);
  ck_assert_int_eq(s21_signbit(-1.0), 1);
  ck_assert_int_eq(s21_signbit(-0.0), 1);
}
END_TEST

START_TEST(s21_sign_test) {
  ck_assert_int_eq(s21_sign(+NAN), 1);
  ck_assert_int_eq(s21_sign(+INFINITY), 1);
  ck_assert_int_eq(s21_sign(+DBL_MAX), 1);
  ck_assert_int_eq(s21_sign(+1.0), 1);
  ck_assert_int_eq(s21_sign(+0.0), 1);
  ck_assert_int_eq(s21_sign(0.0), 1);

  ck_assert_int_eq(s21_sign(-NAN), -1);
  ck_assert_int_eq(s21_sign(-INFINITY), -1);
  ck_assert_int_eq(s21_sign(-DBL_MAX), -1);
  ck_assert_int_eq(s21_sign(-1.0), -1);
  ck_assert_int_eq(s21_sign(-0.0), -1);
}
END_TEST

START_TEST(s21_abs_test) {
  TEST_INT(abs, INT_MIN);
  TEST_INT(abs, INT_MIN + 1);
  TEST_INT(abs, -1234);
  TEST_INT(abs, -123);
  TEST_INT(abs, -12);
  TEST_INT(abs, -1);
  TEST_INT(abs, 0);
  TEST_INT(abs, 1);
  TEST_INT(abs, 12);
  TEST_INT(abs, 123);
  TEST_INT(abs, 1234);
  TEST_INT(abs, INT_MAX - 1);
  TEST_INT(abs, INT_MAX);
}
END_TEST

START_TEST(s21_fabs_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(fabs, -NAN)
  TEST_FLOAT(fabs, -INFINITY)
  TEST_FLOAT(fabs, +INFINITY);
  TEST_FLOAT(fabs, +NAN);

  TEST_FLOAT(fabs, -DBL_MAX)
  TEST_FLOAT(fabs, -1.7976931348623157E+308)
  TEST_FLOAT(fabs, -6.6906999803886251E+30)
  TEST_FLOAT(fabs, -1.0000000000000000E+00)
  TEST_FLOAT(fabs, -1.4946119283948457E-31)
  TEST_FLOAT(fabs, -5.5626846462680040E-309)

  TEST_FLOAT(fabs, -DBL_MIN)
  TEST_FLOAT(fabs, -0.0000000000000000)
  TEST_FLOAT(fabs, 0.0000000000000000)
  TEST_FLOAT(fabs, +0.0000000000000000)
  TEST_FLOAT(fabs, +DBL_MIN)

  TEST_FLOAT(fabs, +5.5626846462680040E-309)
  TEST_FLOAT(fabs, +1.4946119283948457E-31)
  TEST_FLOAT(fabs, +1.0000000000000000E+00)
  TEST_FLOAT(fabs, +6.6906999803886251E+30)
  TEST_FLOAT(fabs, +1.7976931348623157E+308)
  TEST_FLOAT(fabs, +DBL_MAX)
}
END_TEST

START_TEST(s21_floor_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(floor, -NAN)
  TEST_FLOAT(floor, -INFINITY)
  TEST_FLOAT(floor, +INFINITY);
  TEST_FLOAT(floor, +NAN);

  TEST_FLOAT(floor, -9.1234567891234567E+15)
  TEST_FLOAT(floor, -4.4765466227572351E+10)
  TEST_FLOAT(floor, -6.6906999803886251E+8)
  TEST_FLOAT(floor, -33387.000000000001)
  TEST_FLOAT(floor, -499.99999999999999)
  TEST_FLOAT(floor, -499.50000000000000)
  TEST_FLOAT(floor, -7.4583407312002071)
  TEST_FLOAT(floor, -7.0000000000000001)
  TEST_FLOAT(floor, -7.0)
  TEST_FLOAT(floor, -6.9999999999999999)
  TEST_FLOAT(floor, -1.0)
  TEST_FLOAT(floor, -0.223)
  TEST_FLOAT(floor, -0.149)
  TEST_FLOAT(floor, -0.00000123)
  TEST_FLOAT(floor, -3.3387610011627015E-10)
  TEST_FLOAT(floor, -4.9901520183972911E-100)

  TEST_FLOAT(floor, -DBL_MIN)
  TEST_FLOAT(floor, -0.0000000000000000)
  TEST_FLOAT(floor, +0.0000000000000000)
  TEST_FLOAT(floor, +DBL_MIN)

  TEST_FLOAT(floor, -4.9901520183972911E-100)
  TEST_FLOAT(floor, -3.3387610011627015E-10)
  TEST_FLOAT(floor, -0.00000123)
  TEST_FLOAT(floor, -0.149)
  TEST_FLOAT(floor, -0.223)
  TEST_FLOAT(floor, -1.0)
  TEST_FLOAT(floor, -6.9999999999999999)
  TEST_FLOAT(floor, -7.0)
  TEST_FLOAT(floor, -7.0000000000000001)
  TEST_FLOAT(floor, -7.4583407312002071)
  TEST_FLOAT(floor, -499.50000000000000)
  TEST_FLOAT(floor, -499.99999999999999)
  TEST_FLOAT(floor, -33387.000000000001)
  TEST_FLOAT(floor, -6.6906999803886251E+8)
  TEST_FLOAT(floor, -4.4765466227572351E+10)
  TEST_FLOAT(floor, -9.1234567891234567E+15)
}
END_TEST

START_TEST(s21_ceil_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(ceil, -NAN)
  TEST_FLOAT(ceil, -INFINITY)
  TEST_FLOAT(ceil, +INFINITY);
  TEST_FLOAT(ceil, +NAN);

  TEST_FLOAT(ceil, -9.1234567891234567E+15)
  TEST_FLOAT(ceil, -4.4765466227572351E+10)
  TEST_FLOAT(ceil, -6.6906999803886251E+8)
  TEST_FLOAT(ceil, -33387.000000000001)
  TEST_FLOAT(ceil, -499.99999999999999)
  TEST_FLOAT(ceil, -499.50000000000000)
  TEST_FLOAT(ceil, -7.4583407312002071)
  TEST_FLOAT(ceil, -7.0000000000000001)
  TEST_FLOAT(ceil, -7.0)
  TEST_FLOAT(ceil, -6.9999999999999999)
  TEST_FLOAT(ceil, -1.0)
  TEST_FLOAT(ceil, -0.223)
  TEST_FLOAT(ceil, -0.149)
  TEST_FLOAT(ceil, -0.00000123)
  TEST_FLOAT(ceil, -3.3387610011627015E-10)
  TEST_FLOAT(ceil, -4.9901520183972911E-100)

  TEST_FLOAT(ceil, -DBL_MIN)
  TEST_FLOAT(ceil, -0.0000000000000000)
  TEST_FLOAT(ceil, +0.0000000000000000)
  TEST_FLOAT(ceil, +DBL_MIN)

  TEST_FLOAT(ceil, -4.9901520183972911E-100)
  TEST_FLOAT(ceil, -3.3387610011627015E-10)
  TEST_FLOAT(ceil, -0.00000123)
  TEST_FLOAT(ceil, -0.149)
  TEST_FLOAT(ceil, -0.223)
  TEST_FLOAT(ceil, -1.0)
  TEST_FLOAT(ceil, -6.9999999999999999)
  TEST_FLOAT(ceil, -7.0)
  TEST_FLOAT(ceil, -7.0000000000000001)
  TEST_FLOAT(ceil, -7.4583407312002071)
  TEST_FLOAT(ceil, -499.50000000000000)
  TEST_FLOAT(ceil, -499.99999999999999)
  TEST_FLOAT(ceil, -33387.000000000001)
  TEST_FLOAT(ceil, -6.6906999803886251E+8)
  TEST_FLOAT(ceil, -4.4765466227572351E+10)
  TEST_FLOAT(ceil, -9.1234567891234567E+15)
}
END_TEST

START_TEST(s21_fmod_test) {
  TEST_FLOAT(fmod, 0, 0);

  TEST_FLOAT(fmod, +INFINITY, +INFINITY);
  TEST_FLOAT(fmod, -INFINITY, +INFINITY);
  TEST_FLOAT(fmod, +INFINITY, -INFINITY);
  TEST_FLOAT(fmod, -INFINITY, -INFINITY);

  TEST_FLOAT(fmod, +INFINITY, 1);
  TEST_FLOAT(fmod, -INFINITY, 1);
  TEST_FLOAT(fmod, +INFINITY, -1);
  TEST_FLOAT(fmod, -INFINITY, -1);
  TEST_FLOAT(fmod, 1, +INFINITY);
  TEST_FLOAT(fmod, 1, -INFINITY);
  TEST_FLOAT(fmod, -1, +INFINITY);
  TEST_FLOAT(fmod, -1, -INFINITY);

  TEST_FLOAT(fmod, +INFINITY, 0);
  TEST_FLOAT(fmod, -INFINITY, 0);
  TEST_FLOAT(fmod, 0, +INFINITY);
  TEST_FLOAT(fmod, 0, -INFINITY);

  TEST_FLOAT(fmod, +NAN, 0);
  TEST_FLOAT(fmod, -NAN, 0);

  TEST_FLOAT(fmod, +NAN, 1);
  TEST_FLOAT(fmod, -NAN, 1);
  TEST_FLOAT(fmod, +NAN, -1);
  TEST_FLOAT(fmod, -NAN, -1);

  TEST_FLOAT(fmod, +NAN, +NAN);
  TEST_FLOAT(fmod, +NAN, -NAN);
  TEST_FLOAT(fmod, -NAN, +NAN);
  TEST_FLOAT(fmod, -NAN, -NAN);

  TEST_FLOAT(fmod, 0, +NAN);
  TEST_FLOAT(fmod, 0, -NAN);
  TEST_FLOAT(fmod, 1, +NAN);
  TEST_FLOAT(fmod, 1, -NAN);

  TEST_FLOAT(fmod, 1E-5, 1);
  TEST_FLOAT(fmod, -1E-5, 1);
  TEST_FLOAT(fmod, 1E-5, -1);
  TEST_FLOAT(fmod, -1E-5, -1);

  TEST_FLOAT(fmod, 3.5, 1);
  TEST_FLOAT(fmod, -3.5, 1);
  TEST_FLOAT(fmod, 3.5, -1);
  TEST_FLOAT(fmod, -3.5, -1);

  TEST_FLOAT(fmod, 3.5, 2);
  TEST_FLOAT(fmod, -3.5, 2);
  TEST_FLOAT(fmod, 3.5, -2);
  TEST_FLOAT(fmod, -3.5, -2);

  TEST_FLOAT(fmod, 1e10, 0.123);
  TEST_FLOAT(fmod, -1e10, 0.123);
  TEST_FLOAT(fmod, 1e10, -0.123);
  TEST_FLOAT(fmod, -1e10, -0.123);

  TEST_FLOAT(fmod, 1e10, M_PI);
  TEST_FLOAT(fmod, -1e10, M_PI);
  TEST_FLOAT(fmod, 1e10, -M_PI);
  TEST_FLOAT(fmod, -1e10, -M_PI);

  // and for any bigger rate x/y we'll get too big error
  // so I hope it's not necessary in that task
}
END_TEST

START_TEST(s21_sqrt_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(sqrt, -NAN)
  TEST_FLOAT(sqrt, -INFINITY)
  TEST_FLOAT(sqrt, +INFINITY);
  TEST_FLOAT(sqrt, +NAN);

  // ------------------------------------------------
  // log distribution -DBL_MAX ... -0
  // ------------------------------------------------
  TEST_FLOAT(sqrt, -1.7976931348623157E+308)
  TEST_FLOAT(sqrt, -2.6868536029587412E+277)
  TEST_FLOAT(sqrt, -4.0158034448328033E+246)
  TEST_FLOAT(sqrt, -6.0020677307362206E+215)
  TEST_FLOAT(sqrt, -8.9707620253921382E+184)
  TEST_FLOAT(sqrt, -1.3407807929942596E+154)
  TEST_FLOAT(sqrt, -2.0039469665719207E+123)
  TEST_FLOAT(sqrt, -2.9951230401090601E+92)
  TEST_FLOAT(sqrt, -4.4765466227572351E+61)
  TEST_FLOAT(sqrt, -6.6906999803886251E+30)
  TEST_FLOAT(sqrt, -1.0000000000000000E+00)
  TEST_FLOAT(sqrt, -1.4946119283948457E-31)
  TEST_FLOAT(sqrt, -2.2338648165001594E-62)
  TEST_FLOAT(sqrt, -3.3387610011627015E-93)
  TEST_FLOAT(sqrt, -4.9901520183972911E-124)
  TEST_FLOAT(sqrt, -7.4583407312002071E-155)
  TEST_FLOAT(sqrt, -1.1147325022884965E-185)
  TEST_FLOAT(sqrt, -1.6660924948898216E-216)
  TEST_FLOAT(sqrt, -2.4901617166714560E-247)
  TEST_FLOAT(sqrt, -3.7218254053693443E-278)

  // ------------------------------------------------
  // ~ 0
  // ------------------------------------------------
  TEST_FLOAT(sqrt, -DBL_MIN)
  TEST_FLOAT(sqrt, -0.0000000000000000)
  TEST_FLOAT(sqrt, +0.0000000000000000)
  TEST_FLOAT(sqrt, +DBL_MIN)

  // ------------------------------------------------
  // log distribution +0 ... +DBL_MAX
  // ------------------------------------------------
  TEST_FLOAT(sqrt, +3.7218254053693443E-278)
  TEST_FLOAT(sqrt, +2.4901617166714560E-247)
  TEST_FLOAT(sqrt, +1.6660924948898216E-216)
  TEST_FLOAT(sqrt, +1.1147325022884965E-185)
  TEST_FLOAT(sqrt, +7.4583407312002071E-155)
  TEST_FLOAT(sqrt, +4.9901520183972911E-124)
  TEST_FLOAT(sqrt, +3.3387610011627015E-93)
  TEST_FLOAT(sqrt, +2.2338648165001594E-62)
  TEST_FLOAT(sqrt, +1.4946119283948457E-31)
  TEST_FLOAT(sqrt, +1.0000000000000000E+00)

  TEST_FLOAT(sqrt, +1.0000000000000000E+5)
  TEST_FLOAT(sqrt, +1.0000000000000000E+10)
  TEST_FLOAT(sqrt, +1.0000000000000000E+20)
  TEST_FLOAT(sqrt, +1.0000000000000000E+30)
  TEST_FLOAT(sqrt, +1.0000000000000000E+60)

  TEST_FLOAT(sqrt, +6.6906999803886251E+30)
  TEST_FLOAT(sqrt, +4.4765466227572351E+61)
  TEST_FLOAT(sqrt, +2.9951230401090601E+92)
  TEST_FLOAT(sqrt, +2.0039469665719207E+123)
  TEST_FLOAT(sqrt, +1.3407807929942596E+154)
  TEST_FLOAT(sqrt, +8.9707620253921382E+184)
  TEST_FLOAT(sqrt, +6.0020677307362206E+215)
  TEST_FLOAT(sqrt, +4.0158034448328033E+246)
  TEST_FLOAT(sqrt, +2.6868536029587412E+277)
  TEST_FLOAT(sqrt, +1.7976931348623157E+308)
}
END_TEST

START_TEST(s21_sin_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(sin, -NAN)
  TEST_FLOAT(sin, -INFINITY)
  TEST_FLOAT(sin, +INFINITY);
  TEST_FLOAT(sin, +NAN);

  // ------------------------------------------
  // uniform distribution -2*M_PI ... +2*M_PI
  // ------------------------------------------
  TEST_FLOAT(sin, -6.2831853071795862)
  TEST_FLOAT(sin, -5.9766884629269237)
  TEST_FLOAT(sin, -5.6701916186742611)
  TEST_FLOAT(sin, -5.3636947744215986)
  TEST_FLOAT(sin, -5.0571979301689360)
  TEST_FLOAT(sin, -4.7507010859162735)
  TEST_FLOAT(sin, -4.4442042416636109)
  TEST_FLOAT(sin, -4.1377073974109484)
  TEST_FLOAT(sin, -3.8312105531582858)
  TEST_FLOAT(sin, -3.5247137089056233)
  TEST_FLOAT(sin, -3.2182168646529608)
  TEST_FLOAT(sin, -2.9117200204002982)
  TEST_FLOAT(sin, -2.6052231761476357)
  TEST_FLOAT(sin, -2.2987263318949731)
  TEST_FLOAT(sin, -1.9922294876423103)
  TEST_FLOAT(sin, -1.6857326433896476)
  TEST_FLOAT(sin, -1.3792357991369848)
  TEST_FLOAT(sin, -1.0727389548843220)
  TEST_FLOAT(sin, -0.7662421106316593)
  TEST_FLOAT(sin, -0.4597452663789965)
  TEST_FLOAT(sin, -0.1532484221263337)
  TEST_FLOAT(sin, 0.1532484221263291)
  TEST_FLOAT(sin, 0.4597452663789918)
  TEST_FLOAT(sin, 0.7662421106316546)
  TEST_FLOAT(sin, 1.0727389548843174)
  TEST_FLOAT(sin, 1.3792357991369801)
  TEST_FLOAT(sin, 1.6857326433896429)
  TEST_FLOAT(sin, 1.9922294876423057)
  TEST_FLOAT(sin, 2.2987263318949687)
  TEST_FLOAT(sin, 2.6052231761476312)
  TEST_FLOAT(sin, 2.9117200204002938)
  TEST_FLOAT(sin, 3.2182168646529563)
  TEST_FLOAT(sin, 3.5247137089056189)
  TEST_FLOAT(sin, 3.8312105531582814)
  TEST_FLOAT(sin, 4.1377073974109440)
  TEST_FLOAT(sin, 4.4442042416636065)
  TEST_FLOAT(sin, 4.7507010859162691)
  TEST_FLOAT(sin, 5.0571979301689316)
  TEST_FLOAT(sin, 5.3636947744215941)
  TEST_FLOAT(sin, 5.6701916186742567)
  TEST_FLOAT(sin, 5.9766884629269192)
  TEST_FLOAT(sin, 6.2831853071795818)

  // ------------------------------------------
  // log distribution -1e+10 ... +1e+10
  // ------------------------------------------
  TEST_FLOAT(sin, 1.0000000000000000E-10)
  TEST_FLOAT(sin, 3.0747150813218353E-10)
  TEST_FLOAT(sin, 9.4538728313079401E-10)
  TEST_FLOAT(sin, 2.9067965371321282E-09)
  TEST_FLOAT(sin, 8.9375711510542409E-09)
  TEST_FLOAT(sin, 2.7480484808533429E-08)
  TEST_FLOAT(sin, 8.4494661082833322E-08)
  TEST_FLOAT(sin, 2.5979700872256477E-07)
  TEST_FLOAT(sin, 7.9880178080157028E-07)
  TEST_FLOAT(sin, 2.4560878824173270E-06)
  TEST_FLOAT(sin, 7.5517704531203658E-06)
  TEST_FLOAT(sin, 2.3219542502889818E-05)
  TEST_FLOAT(sin, 7.1393477515028679E-05)
  TEST_FLOAT(sin, 2.1951460202347002E-04)
  TEST_FLOAT(sin, 6.7494485741192394E-04)
  TEST_FLOAT(sin, 2.0752631321450582E-03)
  TEST_FLOAT(sin, 6.3808428501175993E-03)
  TEST_FLOAT(sin, 1.9619273742801186E-02)
  TEST_FLOAT(sin, 6.0323676861572295E-02)
  TEST_FLOAT(sin, 1.8547811900706137E-01)
  TEST_FLOAT(sin, 5.7029236976621775E-01)
  TEST_FLOAT(sin, 1.7534865500829584E+00)
  TEST_FLOAT(sin, 5.3914715404350677E+00)
  TEST_FLOAT(sin, 1.6577238855893170E+01)
  TEST_FLOAT(sin, 5.0970286316889055E+01)
  TEST_FLOAT(sin, 1.5671910803783076E+02)
  TEST_FLOAT(sin, 4.8186660501522430E+02)
  TEST_FLOAT(sin, 1.4816025176256620E+03)
  TEST_FLOAT(sin, 4.5555056054680234E+03)
  TEST_FLOAT(sin, 1.4006881788178690E+04)
  TEST_FLOAT(sin, 4.3067170676405174E+04)
  TEST_FLOAT(sin, 1.3241927918860450E+05)
  TEST_FLOAT(sin, 4.0715155477896888E+05)
  TEST_FLOAT(sin, 1.2518750258625290E+06)
  TEST_FLOAT(sin, 3.8491590219496804E+06)
  TEST_FLOAT(sin, 1.1835067295194688E+07)
  TEST_FLOAT(sin, 3.6389459900993927E+07)
  TEST_FLOAT(sin, 1.1188722115874221E+08)
  TEST_FLOAT(sin, 3.4402132630397621E+08)
  TEST_FLOAT(sin, 1.0577675602831759E+09)
  TEST_FLOAT(sin, 3.2523338701356844E+09)
  TEST_FLOAT(sin, 1.0000000000000000E+10)

  // ------------------------------------------------
  // ~ 0
  // ------------------------------------------------
  TEST_FLOAT(sin, -DBL_MIN)
  TEST_FLOAT(sin, -0.0000000000000000)
  TEST_FLOAT(sin, +0.0000000000000000)
  TEST_FLOAT(sin, +DBL_MIN)

  // ------------------------------------------------
  // log distribution -1e-10 ... -1e+10
  // ------------------------------------------------
  TEST_FLOAT(sin, -1.0000000000000000E-10)
  TEST_FLOAT(sin, -3.0747150813218353E-10)
  TEST_FLOAT(sin, -9.4538728313079401E-10)
  TEST_FLOAT(sin, -2.9067965371321282E-09)
  TEST_FLOAT(sin, -8.9375711510542409E-09)
  TEST_FLOAT(sin, -2.7480484808533429E-08)
  TEST_FLOAT(sin, -8.4494661082833322E-08)
  TEST_FLOAT(sin, -2.5979700872256477E-07)
  TEST_FLOAT(sin, -7.9880178080157028E-07)
  TEST_FLOAT(sin, -2.4560878824173270E-06)
  TEST_FLOAT(sin, -7.5517704531203658E-06)
  TEST_FLOAT(sin, -2.3219542502889818E-05)
  TEST_FLOAT(sin, -7.1393477515028679E-05)
  TEST_FLOAT(sin, -2.1951460202347002E-04)
  TEST_FLOAT(sin, -6.7494485741192394E-04)
  TEST_FLOAT(sin, -2.0752631321450582E-03)
  TEST_FLOAT(sin, -6.3808428501175993E-03)
  TEST_FLOAT(sin, -1.9619273742801186E-02)
  TEST_FLOAT(sin, -6.0323676861572295E-02)
  TEST_FLOAT(sin, -1.8547811900706137E-01)
  TEST_FLOAT(sin, -5.7029236976621775E-01)
  TEST_FLOAT(sin, -1.7534865500829584E+00)
  TEST_FLOAT(sin, -5.3914715404350677E+00)
  TEST_FLOAT(sin, -1.6577238855893170E+01)
  TEST_FLOAT(sin, -5.0970286316889055E+01)
  TEST_FLOAT(sin, -1.5671910803783076E+02)
  TEST_FLOAT(sin, -4.8186660501522430E+02)
  TEST_FLOAT(sin, -1.4816025176256620E+03)
  TEST_FLOAT(sin, -4.5555056054680234E+03)
  TEST_FLOAT(sin, -1.4006881788178690E+04)
  TEST_FLOAT(sin, -4.3067170676405174E+04)
  TEST_FLOAT(sin, -1.3241927918860450E+05)
  TEST_FLOAT(sin, -4.0715155477896888E+05)
  TEST_FLOAT(sin, -1.2518750258625290E+06)
  TEST_FLOAT(sin, -3.8491590219496804E+06)
  TEST_FLOAT(sin, -1.1835067295194688E+07)
  TEST_FLOAT(sin, -3.6389459900993927E+07)
  TEST_FLOAT(sin, -1.1188722115874221E+08)
  TEST_FLOAT(sin, -3.4402132630397621E+08)
  TEST_FLOAT(sin, -1.0577675602831759E+09)
  TEST_FLOAT(sin, -3.2523338701356844E+09)
  TEST_FLOAT(sin, -1.0000000000000000E+10)
}
END_TEST

START_TEST(s21_cos_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(cos, -NAN)
  TEST_FLOAT(cos, -INFINITY)
  TEST_FLOAT(cos, +INFINITY);
  TEST_FLOAT(cos, +NAN);

  // ------------------------------------------
  // uniform distribution -2*M_PI ... +2*M_PI
  // ------------------------------------------
  TEST_FLOAT(cos, -6.2831853071795862)
  TEST_FLOAT(cos, -5.9766884629269237)
  TEST_FLOAT(cos, -5.6701916186742611)
  TEST_FLOAT(cos, -5.3636947744215986)
  TEST_FLOAT(cos, -5.0571979301689360)
  TEST_FLOAT(cos, -4.7507010859162735)
  TEST_FLOAT(cos, -4.4442042416636109)
  TEST_FLOAT(cos, -4.1377073974109484)
  TEST_FLOAT(cos, -3.8312105531582858)
  TEST_FLOAT(cos, -3.5247137089056233)
  TEST_FLOAT(cos, -3.2182168646529608)
  TEST_FLOAT(cos, -2.9117200204002982)
  TEST_FLOAT(cos, -2.6052231761476357)
  TEST_FLOAT(cos, -2.2987263318949731)
  TEST_FLOAT(cos, -1.9922294876423103)
  TEST_FLOAT(cos, -1.6857326433896476)
  TEST_FLOAT(cos, -1.3792357991369848)
  TEST_FLOAT(cos, -1.0727389548843220)
  TEST_FLOAT(cos, -0.7662421106316593)
  TEST_FLOAT(cos, -0.4597452663789965)
  TEST_FLOAT(cos, -0.1532484221263337)
  TEST_FLOAT(cos, 0.1532484221263291)
  TEST_FLOAT(cos, 0.4597452663789918)
  TEST_FLOAT(cos, 0.7662421106316546)
  TEST_FLOAT(cos, 1.0727389548843174)
  TEST_FLOAT(cos, 1.3792357991369801)
  TEST_FLOAT(cos, 1.6857326433896429)
  TEST_FLOAT(cos, 1.9922294876423057)
  TEST_FLOAT(cos, 2.2987263318949687)
  TEST_FLOAT(cos, 2.6052231761476312)
  TEST_FLOAT(cos, 2.9117200204002938)
  TEST_FLOAT(cos, 3.2182168646529563)
  TEST_FLOAT(cos, 3.5247137089056189)
  TEST_FLOAT(cos, 3.8312105531582814)
  TEST_FLOAT(cos, 4.1377073974109440)
  TEST_FLOAT(cos, 4.4442042416636065)
  TEST_FLOAT(cos, 4.7507010859162691)
  TEST_FLOAT(cos, 5.0571979301689316)
  TEST_FLOAT(cos, 5.3636947744215941)
  TEST_FLOAT(cos, 5.6701916186742567)
  TEST_FLOAT(cos, 5.9766884629269192)
  TEST_FLOAT(cos, 6.2831853071795818)

  // ------------------------------------------
  // log distribution -1e+10 ... +1e+10
  // ------------------------------------------
  TEST_FLOAT(cos, 1.0000000000000000E-10)
  TEST_FLOAT(cos, 3.0747150813218353E-10)
  TEST_FLOAT(cos, 9.4538728313079401E-10)
  TEST_FLOAT(cos, 2.9067965371321282E-09)
  TEST_FLOAT(cos, 8.9375711510542409E-09)
  TEST_FLOAT(cos, 2.7480484808533429E-08)
  TEST_FLOAT(cos, 8.4494661082833322E-08)
  TEST_FLOAT(cos, 2.5979700872256477E-07)
  TEST_FLOAT(cos, 7.9880178080157028E-07)
  TEST_FLOAT(cos, 2.4560878824173270E-06)
  TEST_FLOAT(cos, 7.5517704531203658E-06)
  TEST_FLOAT(cos, 2.3219542502889818E-05)
  TEST_FLOAT(cos, 7.1393477515028679E-05)
  TEST_FLOAT(cos, 2.1951460202347002E-04)
  TEST_FLOAT(cos, 6.7494485741192394E-04)
  TEST_FLOAT(cos, 2.0752631321450582E-03)
  TEST_FLOAT(cos, 6.3808428501175993E-03)
  TEST_FLOAT(cos, 1.9619273742801186E-02)
  TEST_FLOAT(cos, 6.0323676861572295E-02)
  TEST_FLOAT(cos, 1.8547811900706137E-01)
  TEST_FLOAT(cos, 5.7029236976621775E-01)
  TEST_FLOAT(cos, 1.7534865500829584E+00)
  TEST_FLOAT(cos, 5.3914715404350677E+00)
  TEST_FLOAT(cos, 1.6577238855893170E+01)
  TEST_FLOAT(cos, 5.0970286316889055E+01)
  TEST_FLOAT(cos, 1.5671910803783076E+02)
  TEST_FLOAT(cos, 4.8186660501522430E+02)
  TEST_FLOAT(cos, 1.4816025176256620E+03)
  TEST_FLOAT(cos, 4.5555056054680234E+03)
  TEST_FLOAT(cos, 1.4006881788178690E+04)
  TEST_FLOAT(cos, 4.3067170676405174E+04)
  TEST_FLOAT(cos, 1.3241927918860450E+05)
  TEST_FLOAT(cos, 4.0715155477896888E+05)
  TEST_FLOAT(cos, 1.2518750258625290E+06)
  TEST_FLOAT(cos, 3.8491590219496804E+06)
  TEST_FLOAT(cos, 1.1835067295194688E+07)
  TEST_FLOAT(cos, 3.6389459900993927E+07)
  TEST_FLOAT(cos, 1.1188722115874221E+08)
  TEST_FLOAT(cos, 3.4402132630397621E+08)
  TEST_FLOAT(cos, 1.0577675602831759E+09)
  TEST_FLOAT(cos, 3.2523338701356844E+09)
  TEST_FLOAT(cos, 1.0000000000000000E+10)

  // ------------------------------------------------
  // ~ 0
  // ------------------------------------------------
  TEST_FLOAT(cos, -DBL_MIN)
  TEST_FLOAT(cos, -0.0000000000000000)
  TEST_FLOAT(cos, +0.0000000000000000)
  TEST_FLOAT(cos, +DBL_MIN)

  // ------------------------------------------------
  // log distribution -1e-10 ... -1e+10
  // ------------------------------------------------
  TEST_FLOAT(cos, -1.0000000000000000E-10)
  TEST_FLOAT(cos, -3.0747150813218353E-10)
  TEST_FLOAT(cos, -9.4538728313079401E-10)
  TEST_FLOAT(cos, -2.9067965371321282E-09)
  TEST_FLOAT(cos, -8.9375711510542409E-09)
  TEST_FLOAT(cos, -2.7480484808533429E-08)
  TEST_FLOAT(cos, -8.4494661082833322E-08)
  TEST_FLOAT(cos, -2.5979700872256477E-07)
  TEST_FLOAT(cos, -7.9880178080157028E-07)
  TEST_FLOAT(cos, -2.4560878824173270E-06)
  TEST_FLOAT(cos, -7.5517704531203658E-06)
  TEST_FLOAT(cos, -2.3219542502889818E-05)
  TEST_FLOAT(cos, -7.1393477515028679E-05)
  TEST_FLOAT(cos, -2.1951460202347002E-04)
  TEST_FLOAT(cos, -6.7494485741192394E-04)
  TEST_FLOAT(cos, -2.0752631321450582E-03)
  TEST_FLOAT(cos, -6.3808428501175993E-03)
  TEST_FLOAT(cos, -1.9619273742801186E-02)
  TEST_FLOAT(cos, -6.0323676861572295E-02)
  TEST_FLOAT(cos, -1.8547811900706137E-01)
  TEST_FLOAT(cos, -5.7029236976621775E-01)
  TEST_FLOAT(cos, -1.7534865500829584E+00)
  TEST_FLOAT(cos, -5.3914715404350677E+00)
  TEST_FLOAT(cos, -1.6577238855893170E+01)
  TEST_FLOAT(cos, -5.0970286316889055E+01)
  TEST_FLOAT(cos, -1.5671910803783076E+02)
  TEST_FLOAT(cos, -4.8186660501522430E+02)
  TEST_FLOAT(cos, -1.4816025176256620E+03)
  TEST_FLOAT(cos, -4.5555056054680234E+03)
  TEST_FLOAT(cos, -1.4006881788178690E+04)
  TEST_FLOAT(cos, -4.3067170676405174E+04)
  TEST_FLOAT(cos, -1.3241927918860450E+05)
  TEST_FLOAT(cos, -4.0715155477896888E+05)
  TEST_FLOAT(cos, -1.2518750258625290E+06)
  TEST_FLOAT(cos, -3.8491590219496804E+06)
  TEST_FLOAT(cos, -1.1835067295194688E+07)
  TEST_FLOAT(cos, -3.6389459900993927E+07)
  TEST_FLOAT(cos, -1.1188722115874221E+08)
  TEST_FLOAT(cos, -3.4402132630397621E+08)
  TEST_FLOAT(cos, -1.0577675602831759E+09)
  TEST_FLOAT(cos, -3.2523338701356844E+09)
  TEST_FLOAT(cos, -1.0000000000000000E+10)
}
END_TEST

START_TEST(s21_tan_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(tan, -NAN)
  TEST_FLOAT(tan, -INFINITY)
  TEST_FLOAT(tan, +INFINITY);
  TEST_FLOAT(tan, +NAN);

  // ------------------------------------------
  // tan(PI*K) = 0, K - integer number
  // ------------------------------------------
  TEST_FLOAT(tan, -1000000 * M_PI);
  TEST_FLOAT(tan, -1000 * M_PI);
  TEST_FLOAT(tan, -10 * M_PI);
  TEST_FLOAT(tan, -1 * M_PI);
  TEST_FLOAT(tan, 0 * M_PI);
  TEST_FLOAT(tan, 1 * M_PI);
  TEST_FLOAT(tan, 10 * M_PI);
  TEST_FLOAT(tan, 1000 * M_PI);
  TEST_FLOAT(tan, 1000000 * M_PI);

  // ------------------------------------------
  // tan(PI/2 + PI*K) -> oo, K - integer number
  // ------------------------------------------
  long double inf_threshold = 2.0 / S21_TEST_EPS;
  ck_assert_ldouble_ge(fabsl(s21_tan(0.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(1.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(10.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(1000.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(1000000.5 * M_PI)), inf_threshold);

  ck_assert_ldouble_ge(fabsl(s21_tan(-0.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(-1.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(-10.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(-1000.5 * M_PI)), inf_threshold);
  ck_assert_ldouble_ge(fabsl(s21_tan(-1000000.5 * M_PI)), inf_threshold);

  // ------------------------------------------
  // uniform distribution -2*M_PI ... +2*M_PI
  // ------------------------------------------
  TEST_FLOAT(tan, -6.2831853071795862)
  TEST_FLOAT(tan, -5.9766884629269237)
  TEST_FLOAT(tan, -5.6701916186742611)
  TEST_FLOAT(tan, -5.3636947744215986)
  TEST_FLOAT(tan, -5.0571979301689360)
  TEST_FLOAT(tan, -4.7507010859162735)
  TEST_FLOAT(tan, -4.4442042416636109)
  TEST_FLOAT(tan, -4.1377073974109484)
  TEST_FLOAT(tan, -3.8312105531582858)
  TEST_FLOAT(tan, -3.5247137089056233)
  TEST_FLOAT(tan, -3.2182168646529608)
  TEST_FLOAT(tan, -2.9117200204002982)
  TEST_FLOAT(tan, -2.6052231761476357)
  TEST_FLOAT(tan, -2.2987263318949731)
  TEST_FLOAT(tan, -1.9922294876423103)
  TEST_FLOAT(tan, -1.6857326433896476)
  TEST_FLOAT(tan, -1.3792357991369848)
  TEST_FLOAT(tan, -1.0727389548843220)
  TEST_FLOAT(tan, -0.7662421106316593)
  TEST_FLOAT(tan, -0.4597452663789965)
  TEST_FLOAT(tan, -0.1532484221263337)
  TEST_FLOAT(tan, 0.1532484221263291)
  TEST_FLOAT(tan, 0.4597452663789918)
  TEST_FLOAT(tan, 0.7662421106316546)
  TEST_FLOAT(tan, 1.0727389548843174)
  TEST_FLOAT(tan, 1.3792357991369801)
  TEST_FLOAT(tan, 1.6857326433896429)
  TEST_FLOAT(tan, 1.9922294876423057)
  TEST_FLOAT(tan, 2.2987263318949687)
  TEST_FLOAT(tan, 2.6052231761476312)
  TEST_FLOAT(tan, 2.9117200204002938)
  TEST_FLOAT(tan, 3.2182168646529563)
  TEST_FLOAT(tan, 3.5247137089056189)
  TEST_FLOAT(tan, 3.8312105531582814)
  TEST_FLOAT(tan, 4.1377073974109440)
  TEST_FLOAT(tan, 4.4442042416636065)
  TEST_FLOAT(tan, 4.7507010859162691)
  TEST_FLOAT(tan, 5.0571979301689316)
  TEST_FLOAT(tan, 5.3636947744215941)
  TEST_FLOAT(tan, 5.6701916186742567)
  TEST_FLOAT(tan, 5.9766884629269192)
  TEST_FLOAT(tan, 6.2831853071795818)

  // ------------------------------------------
  // log distribution -1e+10 ... +1e+10
  // ------------------------------------------
  TEST_FLOAT(tan, 1.0000000000000000E-10)
  TEST_FLOAT(tan, 3.0747150813218353E-10)
  TEST_FLOAT(tan, 9.4538728313079401E-10)
  TEST_FLOAT(tan, 2.9067965371321282E-09)
  TEST_FLOAT(tan, 8.9375711510542409E-09)
  TEST_FLOAT(tan, 2.7480484808533429E-08)
  TEST_FLOAT(tan, 8.4494661082833322E-08)
  TEST_FLOAT(tan, 2.5979700872256477E-07)
  TEST_FLOAT(tan, 7.9880178080157028E-07)
  TEST_FLOAT(tan, 2.4560878824173270E-06)
  TEST_FLOAT(tan, 7.5517704531203658E-06)
  TEST_FLOAT(tan, 2.3219542502889818E-05)
  TEST_FLOAT(tan, 7.1393477515028679E-05)
  TEST_FLOAT(tan, 2.1951460202347002E-04)
  TEST_FLOAT(tan, 6.7494485741192394E-04)
  TEST_FLOAT(tan, 2.0752631321450582E-03)
  TEST_FLOAT(tan, 6.3808428501175993E-03)
  TEST_FLOAT(tan, 1.9619273742801186E-02)
  TEST_FLOAT(tan, 6.0323676861572295E-02)
  TEST_FLOAT(tan, 1.8547811900706137E-01)
  TEST_FLOAT(tan, 5.7029236976621775E-01)
  TEST_FLOAT(tan, 1.7534865500829584E+00)
  TEST_FLOAT(tan, 5.3914715404350677E+00)
  TEST_FLOAT(tan, 1.6577238855893170E+01)
  TEST_FLOAT(tan, 5.0970286316889055E+01)
  TEST_FLOAT(tan, 1.5671910803783076E+02)
  TEST_FLOAT(tan, 4.8186660501522430E+02)
  TEST_FLOAT(tan, 1.4816025176256620E+03)
  TEST_FLOAT(tan, 4.5555056054680234E+03)
  TEST_FLOAT(tan, 1.4006881788178690E+04)
  TEST_FLOAT(tan, 4.3067170676405174E+04)
  TEST_FLOAT(tan, 1.3241927918860450E+05)
  TEST_FLOAT(tan, 4.0715155477896888E+05)
  TEST_FLOAT(tan, 1.2518750258625290E+06)
  TEST_FLOAT(tan, 3.8491590219496804E+06)
  TEST_FLOAT(tan, 1.1835067295194688E+07)
  TEST_FLOAT(tan, 3.6389459900993927E+07)
  TEST_FLOAT(tan, 1.1188722115874221E+08)
  TEST_FLOAT(tan, 3.4402132630397621E+08)
  TEST_FLOAT(tan, 1.0577675602831759E+09)
  TEST_FLOAT(tan, 3.2523338701356844E+09)
  TEST_FLOAT(tan, 1.0000000000000000E+10)

  // ------------------------------------------------
  // ~ 0
  // ------------------------------------------------
  TEST_FLOAT(tan, -DBL_MIN)
  TEST_FLOAT(tan, -0.0000000000000000)
  TEST_FLOAT(tan, +0.0000000000000000)
  TEST_FLOAT(tan, +DBL_MIN)

  // ------------------------------------------------
  // log distribution -1e-10 ... -1e+10
  // ------------------------------------------------
  TEST_FLOAT(tan, -1.0000000000000000E-10)
  TEST_FLOAT(tan, -3.0747150813218353E-10)
  TEST_FLOAT(tan, -9.4538728313079401E-10)
  TEST_FLOAT(tan, -2.9067965371321282E-09)
  TEST_FLOAT(tan, -8.9375711510542409E-09)
  TEST_FLOAT(tan, -2.7480484808533429E-08)
  TEST_FLOAT(tan, -8.4494661082833322E-08)
  TEST_FLOAT(tan, -2.5979700872256477E-07)
  TEST_FLOAT(tan, -7.9880178080157028E-07)
  TEST_FLOAT(tan, -2.4560878824173270E-06)
  TEST_FLOAT(tan, -7.5517704531203658E-06)
  TEST_FLOAT(tan, -2.3219542502889818E-05)
  TEST_FLOAT(tan, -7.1393477515028679E-05)
  TEST_FLOAT(tan, -2.1951460202347002E-04)
  TEST_FLOAT(tan, -6.7494485741192394E-04)
  TEST_FLOAT(tan, -2.0752631321450582E-03)
  TEST_FLOAT(tan, -6.3808428501175993E-03)
  TEST_FLOAT(tan, -1.9619273742801186E-02)
  TEST_FLOAT(tan, -6.0323676861572295E-02)
  TEST_FLOAT(tan, -1.8547811900706137E-01)
  TEST_FLOAT(tan, -5.7029236976621775E-01)
  TEST_FLOAT(tan, -1.7534865500829584E+00)
  TEST_FLOAT(tan, -5.3914715404350677E+00)
  TEST_FLOAT(tan, -1.6577238855893170E+01)
  TEST_FLOAT(tan, -5.0970286316889055E+01)
  TEST_FLOAT(tan, -1.5671910803783076E+02)
  TEST_FLOAT(tan, -4.8186660501522430E+02)
  TEST_FLOAT(tan, -1.4816025176256620E+03)
  TEST_FLOAT(tan, -4.5555056054680234E+03)
  TEST_FLOAT(tan, -1.4006881788178690E+04)
  TEST_FLOAT(tan, -4.3067170676405174E+04)
  TEST_FLOAT(tan, -1.3241927918860450E+05)
  TEST_FLOAT(tan, -4.0715155477896888E+05)
  TEST_FLOAT(tan, -1.2518750258625290E+06)
  TEST_FLOAT(tan, -3.8491590219496804E+06)
  TEST_FLOAT(tan, -1.1835067295194688E+07)
  TEST_FLOAT(tan, -3.6389459900993927E+07)
  TEST_FLOAT(tan, -1.1188722115874221E+08)
  TEST_FLOAT(tan, -3.4402132630397621E+08)
  TEST_FLOAT(tan, -1.0577675602831759E+09)
  TEST_FLOAT(tan, -3.2523338701356844E+09)
  TEST_FLOAT(tan, -1.0000000000000000E+10)
}
END_TEST

START_TEST(s21_log_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(log, -NAN)
  TEST_FLOAT(log, -INFINITY)
  TEST_FLOAT(log, +INFINITY);
  TEST_FLOAT(log, +NAN);

  // ------------------------------------------
  // log(0) -> -oo
  // ------------------------------------------
  TEST_FLOAT(log, 0.0);

  long double inf_threshold = 2.0 / S21_TEST_EPS;
  ck_assert_ldouble_ge(fabsl(-s21_log(+0.0)), inf_threshold);

  // ------------------------------------------
  // log(e) -> 1, log(1) -> 0
  // ------------------------------------------
  TEST_FLOAT(log, M_E);
  TEST_FLOAT(log, M_E * M_E);
  TEST_FLOAT(log, 1.0);

  // ------------------------------------------
  // log distribution -1e+10 ... +1e+10
  // ------------------------------------------
  TEST_FLOAT(log, 1.0000000000000000E-10)
  TEST_FLOAT(log, 3.0747150813218353E-10)
  TEST_FLOAT(log, 9.4538728313079401E-10)
  TEST_FLOAT(log, 2.9067965371321282E-09)
  TEST_FLOAT(log, 8.9375711510542409E-09)
  TEST_FLOAT(log, 2.7480484808533429E-08)
  TEST_FLOAT(log, 8.4494661082833322E-08)
  TEST_FLOAT(log, 2.5979700872256477E-07)
  TEST_FLOAT(log, 7.9880178080157028E-07)
  TEST_FLOAT(log, 2.4560878824173270E-06)
  TEST_FLOAT(log, 7.5517704531203658E-06)
  TEST_FLOAT(log, 2.3219542502889818E-05)
  TEST_FLOAT(log, 7.1393477515028679E-05)
  TEST_FLOAT(log, 2.1951460202347002E-04)
  TEST_FLOAT(log, 6.7494485741192394E-04)
  TEST_FLOAT(log, 2.0752631321450582E-03)
  TEST_FLOAT(log, 6.3808428501175993E-03)
  TEST_FLOAT(log, 1.9619273742801186E-02)
  TEST_FLOAT(log, 6.0323676861572295E-02)
  TEST_FLOAT(log, 1.8547811900706137E-01)
  TEST_FLOAT(log, 5.7029236976621775E-01)
  TEST_FLOAT(log, 1.7534865500829584E+00)
  TEST_FLOAT(log, 5.3914715404350677E+00)
  TEST_FLOAT(log, 1.6577238855893170E+01)
  TEST_FLOAT(log, 5.0970286316889055E+01)
  TEST_FLOAT(log, 1.5671910803783076E+02)
  TEST_FLOAT(log, 4.8186660501522430E+02)
  TEST_FLOAT(log, 1.4816025176256620E+03)
  TEST_FLOAT(log, 4.5555056054680234E+03)
  TEST_FLOAT(log, 1.4006881788178690E+04)
  TEST_FLOAT(log, 4.3067170676405174E+04)
  TEST_FLOAT(log, 1.3241927918860450E+05)
  TEST_FLOAT(log, 4.0715155477896888E+05)
  TEST_FLOAT(log, 1.2518750258625290E+06)
  TEST_FLOAT(log, 3.8491590219496804E+06)
  TEST_FLOAT(log, 1.1835067295194688E+07)
  TEST_FLOAT(log, 3.6389459900993927E+07)
  TEST_FLOAT(log, 1.1188722115874221E+08)
  TEST_FLOAT(log, 3.4402132630397621E+08)
  TEST_FLOAT(log, 1.0577675602831759E+09)
  TEST_FLOAT(log, 3.2523338701356844E+09)
  TEST_FLOAT(log, 1.2345678900000000E+10)
  TEST_FLOAT(log, 1.2345678900000000E+20)
  TEST_FLOAT(log, 1.2345678900000000E+40)
  TEST_FLOAT(log, 1.2345678900000000E+80)
  TEST_FLOAT(log, 1.2345678900000000E+160)
  TEST_FLOAT(log, 1.2345678900000000E+300)

  // ------------------------------------------------
  // ~ 0
  // ------------------------------------------------
  TEST_FLOAT(log, +1E-10)
  TEST_FLOAT(log, +1E-12)
  TEST_FLOAT(log, +1E-50)
  TEST_FLOAT(log, +1E-100)
  TEST_FLOAT(log, +1E-200)
  TEST_FLOAT(log, +1E-300)
  TEST_FLOAT(log, +DBL_MIN)
  TEST_FLOAT(log, +0.0000000000000000)
  TEST_FLOAT(log, -0.0000000000000000)
  TEST_FLOAT(log, -DBL_MIN)

  // ------------------------------------------------
  // check for negative numbers -> nan?
  // ------------------------------------------------
  TEST_FLOAT(log, -1.0000000000000000E-10)
  TEST_FLOAT(log, -2.9067965371321282E-09)
  TEST_FLOAT(log, -2.5979700872256477E-07)
  TEST_FLOAT(log, -2.3219542502889818E-05)
  TEST_FLOAT(log, -2.1951460202347002E-04)
  TEST_FLOAT(log, -1.8547811900706137E-01)
  TEST_FLOAT(log, -5.7029236976621775E-01)
  TEST_FLOAT(log, -1.7534865500829584E+00)
  TEST_FLOAT(log, -5.3914715404350677E+00)
  TEST_FLOAT(log, -1.6577238855893170E+01)
  TEST_FLOAT(log, -4.5555056054680234E+03)
  TEST_FLOAT(log, -1.2518750258625290E+06)
  TEST_FLOAT(log, -1.0577675602831759E+09)
  TEST_FLOAT(log, -3.2523338701356844E+09)
  TEST_FLOAT(log, -1.0000000000000000E+10)
}
END_TEST

START_TEST(s21_exp_test) {
  TEST_FLOAT(exp, 0);
  TEST_FLOAT(exp, 1);
  TEST_FLOAT(exp, -1);

  TEST_FLOAT(exp, +INFINITY);
  TEST_FLOAT(exp, -INFINITY);

  TEST_FLOAT(exp, +NAN);
  TEST_FLOAT(exp, -NAN);

  //  TEST_FLOAT(exp, 22.517006)
  //  TEST_FLOAT(exp, 20.686583)

  TEST_FLOAT(exp, 8.327065)
  TEST_FLOAT(exp, 6.010046)
  TEST_FLOAT(exp, 4.337741)
  TEST_FLOAT(exp, 3.130758)
  TEST_FLOAT(exp, 2.259620)
  TEST_FLOAT(exp, 1.630877)
  TEST_FLOAT(exp, 1.177083)
  TEST_FLOAT(exp, 0.849558)
  TEST_FLOAT(exp, 0.613167)
  TEST_FLOAT(exp, 0.442552)
  TEST_FLOAT(exp, 0.319411)
  TEST_FLOAT(exp, 0.230535)
  TEST_FLOAT(exp, 0.166388)
  TEST_FLOAT(exp, 0.120090)
  TEST_FLOAT(exp, 0.086675)
  TEST_FLOAT(exp, 0.062558)
  TEST_FLOAT(exp, 0.045151)
  TEST_FLOAT(exp, 0.032588)
  TEST_FLOAT(exp, 0.023520)
  TEST_FLOAT(exp, 0.016976)
  TEST_FLOAT(exp, 0.012252)
  TEST_FLOAT(exp, 0.008843)
  TEST_FLOAT(exp, 0.006382)
  TEST_FLOAT(exp, 0.004606)
  TEST_FLOAT(exp, 0.003325)
  TEST_FLOAT(exp, 0.002400)
  TEST_FLOAT(exp, 0.001732)
  TEST_FLOAT(exp, 0.001250)

  // ------------------------------------------------
  // ~ 0
  // ------------------------------------------------
  TEST_FLOAT(exp, -DBL_MIN)
  TEST_FLOAT(exp, -0.0000000000000000)
  TEST_FLOAT(exp, +0.0000000000000000)
  TEST_FLOAT(exp, +DBL_MIN)

  TEST_FLOAT(exp, 0.001250)
  TEST_FLOAT(exp, 0.001732)
  TEST_FLOAT(exp, 0.002400)
  TEST_FLOAT(exp, 0.003325)
  TEST_FLOAT(exp, 0.004606)
  TEST_FLOAT(exp, 0.006382)
  TEST_FLOAT(exp, 0.008843)
  TEST_FLOAT(exp, 0.012252)
  TEST_FLOAT(exp, 0.016976)
  TEST_FLOAT(exp, 0.023520)
  TEST_FLOAT(exp, 0.032588)
  TEST_FLOAT(exp, 0.045151)
  TEST_FLOAT(exp, 0.062558)
  TEST_FLOAT(exp, 0.086675)
  TEST_FLOAT(exp, 0.120090)
  TEST_FLOAT(exp, 0.166388)
  TEST_FLOAT(exp, 0.230535)
  TEST_FLOAT(exp, 0.319411)
  TEST_FLOAT(exp, 0.442552)
  TEST_FLOAT(exp, 0.613167)
  TEST_FLOAT(exp, 0.849558)
  TEST_FLOAT(exp, 1.177083)
  TEST_FLOAT(exp, 1.630877)
  TEST_FLOAT(exp, 2.259620)
  TEST_FLOAT(exp, 3.130758)
  TEST_FLOAT(exp, 4.337741)
  TEST_FLOAT(exp, 6.010046)
  TEST_FLOAT(exp, 8.327065)

  //  TEST_FLOAT(exp, 11.537351)
  //  TEST_FLOAT(exp, 15.985280)
  //  TEST_FLOAT(exp, 22.147993)
  //  TEST_FLOAT(exp, 30.686583)

  //  TEST_FLOAT(exp, 42.517006)
  //  TEST_FLOAT(exp, 58.908345)
  //  TEST_FLOAT(exp, 81.618943)
  //  TEST_FLOAT(exp, 113.085029)
}
END_TEST

START_TEST(s21_pow_test) {
  TEST_FLOAT(pow, 0, 0);

  TEST_FLOAT(pow, +INFINITY, +INFINITY);
  TEST_FLOAT(pow, -INFINITY, +INFINITY);
  TEST_FLOAT(pow, +INFINITY, -INFINITY);
  TEST_FLOAT(pow, -INFINITY, -INFINITY);
  TEST_FLOAT(pow, +INFINITY, 1);
  TEST_FLOAT(pow, -INFINITY, 1);

  TEST_FLOAT(pow, +INFINITY, -1);
  TEST_FLOAT(pow, -INFINITY, -1);
  TEST_FLOAT(pow, 1, +INFINITY);
  TEST_FLOAT(pow, 1, -INFINITY);
  TEST_FLOAT(pow, -1, +INFINITY);
  TEST_FLOAT(pow, -1, -INFINITY);

  TEST_FLOAT(pow, +INFINITY, 0);
  TEST_FLOAT(pow, -INFINITY, 0);
  TEST_FLOAT(pow, 0, +INFINITY);
  TEST_FLOAT(pow, 0, -INFINITY);

  TEST_FLOAT(pow, 2, +INFINITY);
  TEST_FLOAT(pow, 2, -INFINITY);
  TEST_FLOAT(pow, -2, +INFINITY);
  TEST_FLOAT(pow, -2, -INFINITY);

  TEST_FLOAT(pow, 0.5, +INFINITY);
  TEST_FLOAT(pow, 0.5, -INFINITY);
  TEST_FLOAT(pow, -0.5, +INFINITY);
  TEST_FLOAT(pow, -0.5, -INFINITY);

  TEST_FLOAT(pow, +NAN, 0);
  TEST_FLOAT(pow, -NAN, 0);

  TEST_FLOAT(pow, +NAN, 1);
  TEST_FLOAT(pow, -NAN, 1);
  TEST_FLOAT(pow, +NAN, -1);
  TEST_FLOAT(pow, -NAN, -1);

  TEST_FLOAT(pow, 0, +NAN);
  TEST_FLOAT(pow, 0, -NAN);
  TEST_FLOAT(pow, 1, +NAN);
  TEST_FLOAT(pow, 1, -NAN);
  TEST_FLOAT(pow, -1, +NAN);
  TEST_FLOAT(pow, -1, -NAN);

  TEST_FLOAT(pow, 2, +NAN);
  TEST_FLOAT(pow, 2, -NAN);
  TEST_FLOAT(pow, -2, +NAN);
  TEST_FLOAT(pow, -2, -NAN);

  TEST_FLOAT(pow, +NAN, +NAN);
  TEST_FLOAT(pow, +NAN, -NAN);
  TEST_FLOAT(pow, -NAN, +NAN);
  TEST_FLOAT(pow, -NAN, -NAN);

  TEST_FLOAT(pow, 1, 0);
  TEST_FLOAT(pow, 1, -1);
  TEST_FLOAT(pow, 1, -2);
  TEST_FLOAT(pow, 1, -5);
  TEST_FLOAT(pow, 1, -10);
  TEST_FLOAT(pow, 1, -100);
  TEST_FLOAT(pow, 1, -100000);

  TEST_FLOAT(pow, 1, 0);
  TEST_FLOAT(pow, 1, 1);
  TEST_FLOAT(pow, 1, 2);
  TEST_FLOAT(pow, 1, 5);
  TEST_FLOAT(pow, 1, 10);
  TEST_FLOAT(pow, 1, 100);

  TEST_FLOAT(pow, -1, 0);
  TEST_FLOAT(pow, -1, -1);
  TEST_FLOAT(pow, -1, -2);
  TEST_FLOAT(pow, -1, -5);
  TEST_FLOAT(pow, -1, -10);
  TEST_FLOAT(pow, -1, -100);
  TEST_FLOAT(pow, -1, -100000);

  TEST_FLOAT(pow, -1, 0);
  TEST_FLOAT(pow, -1, 1);
  TEST_FLOAT(pow, -1, 2);
  TEST_FLOAT(pow, -1, 5);
  TEST_FLOAT(pow, -1, 10);
  TEST_FLOAT(pow, -1, 100);

  TEST_FLOAT(pow, 1, 0.5);
  TEST_FLOAT(pow, 2, 0.5);
  TEST_FLOAT(pow, 4, 0.5);
  TEST_FLOAT(pow, 9, 0.5);
  TEST_FLOAT(pow, 16, 0.5);
  TEST_FLOAT(pow, 25, 0.5);

  TEST_FLOAT(pow, 1, 1. / 3.);
  TEST_FLOAT(pow, 2, 1. / 3.);
  TEST_FLOAT(pow, 4, 1. / 3.);
  TEST_FLOAT(pow, 9, 1. / 3.);
  TEST_FLOAT(pow, 16, 1. / 3.);
  TEST_FLOAT(pow, 25, 1. / 3.);

  TEST_FLOAT(pow, 1, 0.5);
  TEST_FLOAT(pow, 2, 0.5);
  TEST_FLOAT(pow, 4, 0.5);
  TEST_FLOAT(pow, 9, 0.5);
  TEST_FLOAT(pow, 16, 0.5);
  TEST_FLOAT(pow, 25, 0.5);

  TEST_FLOAT(pow, -1, 0.5);
  TEST_FLOAT(pow, -1, 1.1);
  TEST_FLOAT(pow, -1, 2.9);
  TEST_FLOAT(pow, -1, 5.00001);

  TEST_FLOAT(pow, -1, -0.5);
  TEST_FLOAT(pow, -1, -1.1);
  TEST_FLOAT(pow, -1, -2.9);
  TEST_FLOAT(pow, -1, -5.00001);

  TEST_FLOAT(pow, 2, 10);
  TEST_FLOAT(pow, 2, 10.5);
  TEST_FLOAT(pow, 2, -10);

  TEST_FLOAT(pow, 2, 50);
  TEST_FLOAT(pow, 2, -100);

  // ------------------------------------------------
  // ~ 0
  // ------------------------------------------------
  TEST_FLOAT(pow, -DBL_MIN, 0.56789);
  TEST_FLOAT(pow, -0.0000000000000000, 0.56789);
  TEST_FLOAT(pow, +0.0000000000000000, 0.56789);
  TEST_FLOAT(pow, +DBL_MIN, 0.56789);

  // ------------------------------------------
  // log distribution -1e+10 ... +1e+10
  // ------------------------------------------
  TEST_FLOAT(pow, 1.0000000000000000E-10, 0.1);
  TEST_FLOAT(pow, 3.0747150813218353E-10, 0.2);
  TEST_FLOAT(pow, 9.4538728313079401E-10, 0.3);
  TEST_FLOAT(pow, 2.9067965371321282E-09, 0.4);
  TEST_FLOAT(pow, 8.9375711510542409E-09, 0.5);
  TEST_FLOAT(pow, 2.7480484808533429E-08, 0.6);
  TEST_FLOAT(pow, 8.4494661082833322E-08, 0.7);
  TEST_FLOAT(pow, 2.5979700872256477E-07, 0.8);
  TEST_FLOAT(pow, 7.9880178080157028E-07, 0.9);
  TEST_FLOAT(pow, 2.4560878824173270E-06, 0.1);
  TEST_FLOAT(pow, 7.5517704531203658E-06, 0.2);
  TEST_FLOAT(pow, 2.3219542502889818E-05, 0.3);
  TEST_FLOAT(pow, 7.1393477515028679E-05, 0.4);
  TEST_FLOAT(pow, 2.1951460202347002E-04, 0.5);
  TEST_FLOAT(pow, 6.7494485741192394E-04, 0.6);
  TEST_FLOAT(pow, 2.0752631321450582E-03, 0.7);
  TEST_FLOAT(pow, 6.3808428501175993E-03, 0.8);
  TEST_FLOAT(pow, 1.9619273742801186E-02, 0.9);
  TEST_FLOAT(pow, 6.0323676861572295E-02, 0.1);
  TEST_FLOAT(pow, 1.8547811900706137E-01, 0.2);
  TEST_FLOAT(pow, 5.7029236976621775E-01, 0.3);
  TEST_FLOAT(pow, 1.7534865500829584E+00, 0.4);
  TEST_FLOAT(pow, 5.3914715404350677E+00, 0.5);
  TEST_FLOAT(pow, 1.6577238855893170E+01, 0.6);
  TEST_FLOAT(pow, 5.0970286316889055E+01, 0.7);
  TEST_FLOAT(pow, 1.5671910803783076E+02, 0.8);
  TEST_FLOAT(pow, 4.8186660501522430E+02, 0.9);
  TEST_FLOAT(pow, 1.4816025176256620E+03, 0.1);
  TEST_FLOAT(pow, 4.5555056054680234E+03, 0.2);
  TEST_FLOAT(pow, 1.4006881788178690E+04, 0.3);
  TEST_FLOAT(pow, 4.3067170676405174E+04, 0.4);
  TEST_FLOAT(pow, 1.3241927918860450E+05, 0.5);
  TEST_FLOAT(pow, 4.0715155477896888E+05, 0.6);
  TEST_FLOAT(pow, 1.2518750258625290E+06, 0.7);
  TEST_FLOAT(pow, 3.8491590219496804E+06, 0.8);
  TEST_FLOAT(pow, 1.1835067295194688E+07, 0.9);
  TEST_FLOAT(pow, 3.6389459900993927E+07, 0.1);
  TEST_FLOAT(pow, 1.1188722115874221E+08, 0.2);
  TEST_FLOAT(pow, 3.4402132630397621E+08, 0.3);
  TEST_FLOAT(pow, 1.0577675602831759E+09, 0.4);
  TEST_FLOAT(pow, 3.2523338701356844E+09, 0.5);
  TEST_FLOAT(pow, 1.0000000000000000E+10, 0.6);
}
END_TEST

START_TEST(s21_asin_test) {
  TEST_FLOAT(asin, -NAN);
  TEST_FLOAT(asin, +NAN);

  TEST_FLOAT(asin, -INFINITY);
  TEST_FLOAT(asin, +INFINITY);

  TEST_FLOAT(asin, -2);

  TEST_FLOAT(asin, -1);
  TEST_FLOAT(asin, -0.9);
  TEST_FLOAT(asin, -0.8);
  TEST_FLOAT(asin, -0.7);
  TEST_FLOAT(asin, -0.6);
  TEST_FLOAT(asin, -0.5);
  TEST_FLOAT(asin, -0.4);
  TEST_FLOAT(asin, -0.3);
  TEST_FLOAT(asin, -0.2);
  TEST_FLOAT(asin, -0.1);

  TEST_FLOAT(asin, 0);

  TEST_FLOAT(asin, 0.1);
  TEST_FLOAT(asin, 0.2);
  TEST_FLOAT(asin, 0.3);
  TEST_FLOAT(asin, 0.4);
  TEST_FLOAT(asin, 0.5);
  TEST_FLOAT(asin, 0.6);
  TEST_FLOAT(asin, 0.7);
  TEST_FLOAT(asin, 0.8);
  TEST_FLOAT(asin, 0.9);
  TEST_FLOAT(asin, 1);

  TEST_FLOAT(asin, 2);
}
END_TEST

START_TEST(s21_acos_test) {
  TEST_FLOAT(acos, -NAN);
  TEST_FLOAT(acos, +NAN);

  TEST_FLOAT(acos, -INFINITY);
  TEST_FLOAT(acos, +INFINITY);

  TEST_FLOAT(acos, -2);

  TEST_FLOAT(acos, -1);
  TEST_FLOAT(acos, -0.9);
  TEST_FLOAT(acos, -0.8);
  TEST_FLOAT(acos, -0.7);
  TEST_FLOAT(acos, -0.6);
  TEST_FLOAT(acos, -0.5);
  TEST_FLOAT(acos, -0.4);
  TEST_FLOAT(acos, -0.3);
  TEST_FLOAT(acos, -0.2);
  TEST_FLOAT(acos, -0.1);

  TEST_FLOAT(acos, 0);

  TEST_FLOAT(acos, 0.1);
  TEST_FLOAT(acos, 0.2);
  TEST_FLOAT(acos, 0.3);
  TEST_FLOAT(acos, 0.4);
  TEST_FLOAT(acos, 0.5);
  TEST_FLOAT(acos, 0.6);
  TEST_FLOAT(acos, 0.7);
  TEST_FLOAT(acos, 0.8);
  TEST_FLOAT(acos, 0.9);
  TEST_FLOAT(acos, 1);

  TEST_FLOAT(acos, 2);
}
END_TEST

START_TEST(s21_atan_test) {
  // ------------------------------------------
  // INF & NAN
  // ------------------------------------------
  TEST_FLOAT(atan, -NAN)
  TEST_FLOAT(atan, -INFINITY)
  TEST_FLOAT(atan, +INFINITY);
  TEST_FLOAT(atan, +NAN);

  TEST_FLOAT(atan, -9.1234567891234567E+15)
  TEST_FLOAT(atan, -4.4765466227572351E+10)
  TEST_FLOAT(atan, -6.6906999803886251E+8)
  TEST_FLOAT(atan, -33387.000000000001)
  TEST_FLOAT(atan, -499.99999999999999)
  TEST_FLOAT(atan, -499.50000000000000)
  TEST_FLOAT(atan, -7.4583407312002071)
  TEST_FLOAT(atan, -7.0000000000000001)
  TEST_FLOAT(atan, -7.0)
  TEST_FLOAT(atan, -6.9999999999999999)
  TEST_FLOAT(atan, -1.0)
  TEST_FLOAT(atan, -0.223)
  TEST_FLOAT(atan, -0.149)
  TEST_FLOAT(atan, -0.00000123)
  TEST_FLOAT(atan, -3.3387610011627015E-10)
  TEST_FLOAT(atan, -4.9901520183972911E-100)

  TEST_FLOAT(atan, -DBL_MIN)
  TEST_FLOAT(atan, -0.0000000000000000)
  TEST_FLOAT(atan, +0.0000000000000000)
  TEST_FLOAT(atan, +DBL_MIN)

  TEST_FLOAT(atan, +4.9901520183972911E-100)
  TEST_FLOAT(atan, +3.3387610011627015E-10)
  TEST_FLOAT(atan, +0.00000123)
  TEST_FLOAT(atan, +0.149)
  TEST_FLOAT(atan, +0.223)
  TEST_FLOAT(atan, +1.0)
  TEST_FLOAT(atan, +6.9999999999999999)
  TEST_FLOAT(atan, +7.0)
  TEST_FLOAT(atan, +7.0000000000000001)
  TEST_FLOAT(atan, +7.4583407312002071)
  TEST_FLOAT(atan, +499.50000000000000)
  TEST_FLOAT(atan, +499.99999999999999)
  TEST_FLOAT(atan, +33387.000000000001)
  TEST_FLOAT(atan, +6.6906999803886251E+8)
  TEST_FLOAT(atan, +4.4765466227572351E+10)
  TEST_FLOAT(atan, +9.1234567891234567E+15)
}
END_TEST

Suite *Create_suite() {
  Suite *suite = suite_create("s21_math_tests");
  TCase *tcase_core = tcase_create("Core");

  tcase_add_test(tcase_core, s21_isnan_test);
  tcase_add_test(tcase_core, s21_isinf_test);
  tcase_add_test(tcase_core, s21_signbit_test);
  tcase_add_test(tcase_core, s21_sign_test);

  tcase_add_test(tcase_core, s21_abs_test);
  tcase_add_test(tcase_core, s21_fabs_test);
  tcase_add_test(tcase_core, s21_floor_test);
  tcase_add_test(tcase_core, s21_fmod_test);
  tcase_add_test(tcase_core, s21_sqrt_test);

  tcase_add_test(tcase_core, s21_sin_test);
  tcase_add_test(tcase_core, s21_cos_test);
  tcase_add_test(tcase_core, s21_tan_test);

  tcase_add_test(tcase_core, s21_asin_test);
  tcase_add_test(tcase_core, s21_acos_test);
  tcase_add_test(tcase_core, s21_atan_test);

  tcase_add_test(tcase_core, s21_log_test);
  tcase_add_test(tcase_core, s21_exp_test);
  tcase_add_test(tcase_core, s21_pow_test);
  tcase_add_test(tcase_core, s21_ceil_test);

  suite_add_tcase(suite, tcase_core);

  return suite;
}

int main(void) {
  Suite *suite = Create_suite();
  SRunner *suite_runner = srunner_create(suite);
#ifdef MEASURE_TIME
  srunner_set_fork_status(suite_runner, CK_NOFORK);
#endif
  srunner_run_all(suite_runner, CK_NORMAL);
  int failed_count = srunner_ntests_failed(suite_runner);
  srunner_free(suite_runner);

  if (failed_count != 0) {
    printf("Failed tests: %d\n", failed_count);
    return EXIT_FAILURE;
  } else {
    printf("Success\n");
#ifdef MEASURE_TIME
    print_time_table();
#endif
  }
  return EXIT_SUCCESS;
}
